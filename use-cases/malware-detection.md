# 🛡️ Malware Detection with Wazuh

## 🎯 Objective

This demonstration showcases how Wazuh can detect malware-like activity using real-time log monitoring, rule-based alerting, and an intuitive dashboard. We'll simulate a malware event using the EICAR test file — a safe and standardized dummy file — to generate a detection alert in Wazuh.



## 🛠️ Tools Used

- Wazuh Manager (Installed on Ubuntu)
- Wazuh Dashboard
- Optional Wazuh Agent (on another device)
- EICAR Test File – an industry-standard, safe file used for AV and detection testing.


## 🧪 Simulated Detection Use Case

### Scenario:
A user unknowingly downloads a file from a suspicious website. That file contains a known malware signature (simulated using EICAR). Wazuh should pick up this activity and generate an alert.

### Steps:

1. On your Ubuntu terminal or endpoint with Wazuh Agent installed, run:

    ```bash
    echo "X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*" > ~/eicar_test_file.txt
    ```

2. Wait 30–60 seconds for Wazuh to analyze system logs.

3. Go to your **Wazuh Dashboard**.

4. Navigate to:
    - Security Events**
    - Search using query:  
      ```bash
      data: "EICAR"
      ```

    OR

    - Look under Rules and filter by severity or new alerts.


## 📸 Screenshots (Replace these with your own)
Would post screenshots soon😉


## 📝 Detection Breakdown

- The EICAR file was flagged due to its known string signature.
- Wazuh's syscheck or logcollector modules noticed a new suspicious file.
- It triggered a rule, generating an alert with a severity level and timestamp.


## 🔍 Sample JSON Alert (Optional)

```json
{
  "timestamp": "2025-05-28T23:31:00Z",
  "rule": {
    "level": 10,
    "description": "EICAR test file detected",
    "id": "100001"
  },
  "agent": {
    "id": "001",
    "name": "ubuntu-endpoint"
  },
  "manager": {
    "name": "wazuh-manager"
  },
  "data": {
    "file": "/home/user/eicar_test_file.txt"
  }
}

